<img src="{{ url_for('preview_image') }}" alt="Preview image">
<form action="{{ url_for('take_new_picture') }}" method="post">
    <button type="submit">Take New Picture</button><br>
    Sensor data: {{ url_for('home') }} <br><br>
    <a href="read_image">Read Image</a><br>
</form>

<form action="{{ url_for('update_config_route') }}" method="post" id="roi-form">
    <div id="roi-fields">
    <b>NUMBER AREA</b><br>
        {% for roi in rois %}
            <div id="roi{{ loop.index }}">
                <label for="roi{{ loop.index }}">AREA {{ loop.index }}:</label><br>
                <input type="text" id="roi{{ loop.index }}_x" name="roi{{ loop.index }}_x" value="{{ roi[0] }}">
                <input type="text" id="roi{{ loop.index }}_y" name="roi{{ loop.index }}_y" value="{{ roi[1] }}">
                <input type="text" id="roi{{ loop.index }}_w" name="roi{{ loop.index }}_w" value="{{ roi[2] }}">
                <input type="text" id="roi{{ loop.index }}_h" name="roi{{ loop.index }}_h" value="{{ roi[3] }}"><br>
            </div>
        {% endfor %}
    </div>
    <button type="button" id="add-roi">+</button>
    <button type="button" id="remove-roi">-</button><br>
    <br>
    <br>
    <div id="gauge-roi-fields">
    <b>GAUGE AREA</b><br>
    {% for gaugeroi in gaugerois %}
        <div id="roi{{ loop.index }}">
            <label for="gaugeroi{{ loop.index }}">GAUGE AREA {{ loop.index }}:</label><br>
            <input type="text" id="gaugeroi{{ loop.index }}_x" name="gaugeroi{{ loop.index }}_x" value="{{ gaugeroi[0] }}">
            <input type="text" id="gaugeroi{{ loop.index }}_y" name="gaugeroi{{ loop.index }}_y" value="{{ gaugeroi[1] }}">
            <input type="text" id="gaugeroi{{ loop.index }}_w" name="gaugeroi{{ loop.index }}_w" value="{{ gaugeroi[2] }}">
            <input type="text" id="gaugeroi{{ loop.index }}_h" name="gaugeroi{{ loop.index }}_h" value="{{ gaugeroi[3] }}"><br>
        </div>
    {% endfor %}
    </div>
    <button type="button" id="add-gauge-roi">+</button>
    <button type="button" id="remove-gauge-roi">-</button><br>
    <input type="submit" value="Apply">
</form>

<script>
    // NUMBER ROI'S
    var roiCount = {{ rois|length }};
    document.getElementById('add-roi').addEventListener('click', function() {
        roiCount++;
        var roiField = document.createElement('div');
        roiField.innerHTML = `
            <label for="roi${roiCount}">NUMBER ${roiCount}:</label><br>
            <input type="text" id="roi${roiCount}_x" name="roi${roiCount}_x">
            <input type="text" id="roi${roiCount}_y" name="roi${roiCount}_y">
            <input type="text" id="roi${roiCount}_w" name="roi${roiCount}_w">
            <input type="text" id="roi${roiCount}_h" name="roi${roiCount}_h"><br>
        `;
        roiField.id = `roi${roiCount}`;
        document.getElementById('roi-fields').appendChild(roiField);
    });

    document.getElementById('remove-roi').addEventListener('click', function() {
        if (roiCount > 0) {
            var roiField = document.getElementById(`roi${roiCount}`);
            roiField.parentNode.removeChild(roiField);
            roiCount--;
        }
    });
    // GAUGE ROIS
    var gaugeRoiCount = {{ gaugeRois|length }};
    document.getElementById('add-gauge-roi').addEventListener('click', function() {
        gaugeRoiCount++;
        var gaugeRoiField = document.createElement('div');
        gaugeRoiField.innerHTML = `
            <label for="gaugeroi${gaugeRoiCount}">GAUGE ${gaugeRoiCount}:</label><br>
            <input type="text" id="gaugeroi${gaugeRoiCount}_x" name="gaugeroi${gaugeRoiCount}_x">
            <input type="text" id="gaugeroi${gaugeRoiCount}_y" name="gaugeroi${gaugeRoiCount}_y">
            <input type="text" id="gaugeroi${gaugeRoiCount}_w" name="gaugeroi${gaugeRoiCount}_w">
            <input type="text" id="gaugeroi${gaugeRoiCount}_h" name="gaugeroi${gaugeRoiCount}_h"><br>
        `;
        gaugeRoiField.id = `gauge_roi${gaugeRoiCount}`;
        document.getElementById('gauge-roi-fields').appendChild(gaugeRoiField);
    });

    document.getElementById('remove-gauge-roi').addEventListener('click', function() {
        if (roiCount > 0) {
            var gaugeRoiField = document.getElementById(`gaugeroi${gaugeRoiCount}`);
            gaugeRoiField.parentNode.removeChild(gaugeRoiField);
            gaugeRoiCount--;
        }
    });
</script>
