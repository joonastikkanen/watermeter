<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
<div class="container">
    <div class="controls">
            <form action="{{ url_for('update_config_route') }}" method="post" id="roi-form">
                <h2>PRE DECIMAL NUMBER AREAS</h2>
                <br>
                <div id="pre-roi-fields">
                <b>NUMBERS</b><br>
                    {% for preroi in prerois %}
                        <div id="preroi_{{ loop.index }}">
                            <label for="preroi_{{ loop.index }}">NUMBER {{ loop.index }}:</label><br>
                            <input type="text" id="preroi_{{ loop.index }}_x" name="preroi_{{ loop.index }}_x" value="{{ preroi[0] }}" size="8" placeholder="X Position">
                            <input type="text" id="preroi_{{ loop.index }}_y" name="preroi_{{ loop.index }}_y" value="{{ preroi[1] }}" size="8" placeholder="Y Position">
                            <input type="text" id="preroi_{{ loop.index }}_w" name="preroi_{{ loop.index }}_w" value="{{ preroi[2] }}" size="8" placeholder="Width">
                            <input type="text" id="preroi_{{ loop.index }}_h" name="preroi_{{ loop.index }}_h" value="{{ preroi[3] }}" size="8" placeholder="Height"><br>
                        </div>
                    {% endfor %}
                </div>
                <button type="button" id="add-pre-roi">+</button>
                <button type="button" id="remove-pre-roi">-</button><br>
                <br>
                <div id="pre-gauge-roi-fields">
                <b>GAUGES</b><br>
                {% for pregaugeroi in pregaugerois %}
                    <div id="pregaugeroi_{{ loop.index }}">
                        <label for="pregaugeroi_{{ loop.index }}">GAUGE {{ loop.index }}:</label><br>
                        <input type="text" id="pregaugeroi_{{ loop.index }}_x" name="pregaugeroi_{{ loop.index }}_x" value="{{ pregaugeroi[0] }}" size="8" placeholder="X Position">
                        <input type="text" id="pregaugeroi_{{ loop.index }}_y" name="pregaugeroi_{{ loop.index }}_y" value="{{ pregaugeroi[1] }}" size="8" placeholder="Y Position">
                        <input type="text" id="pregaugeroi_{{ loop.index }}_w" name="pregaugeroi_{{ loop.index }}_w" value="{{ pregaugeroi[2] }}" size="8" placeholder="Width">
                        <input type="text" id="pregaugeroi_{{ loop.index }}_h" name="pregaugeroi_{{ loop.index }}_h" value="{{ pregaugeroi[3] }}" size="8" placeholder="Height"><br>
                    </div>
                {% endfor %}
                </div>
                <button type="button" id="add-pre-gauge-roi">+</button>
                <button type="button" id="remove-pre-gauge-roi">-</button><br>
                <br>
                <h2>POST DECIMAL NUMBER AREAS</h2>
                <br>
                <div id="post-roi-fields">
                    <b>NUMBERS</b><br>
                        {% for postroi in postrois %}
                            <div id="postroi_{{ loop.index }}">
                                <label for="postroi_{{ loop.index }}">NUMBER {{ loop.index }}:</label><br>
                                <input type="text" id="postroi_{{ loop.index }}_x" name="postroi_{{ loop.index }}_x" value="{{ postroi[0] }}" size="8" placeholder="X Position">
                                <input type="text" id="postroi_{{ loop.index }}_y" name="postroi_{{ loop.index }}_y" value="{{ postroi[1] }}" size="8" placeholder="Y Position">
                                <input type="text" id="postroi_{{ loop.index }}_w" name="postroi_{{ loop.index }}_w" value="{{ postroi[2] }}" size="8" placeholder="Width">
                                <input type="text" id="postroi_{{ loop.index }}_h" name="postroi_{{ loop.index }}_h" value="{{ postroi[3] }}" size="8" placeholder="Height"><br>
                            </div>
                        {% endfor %}
                    </div>
                    <button type="button" id="add-post-roi">+</button>
                    <button type="button" id="remove-post-roi">-</button><br>
                    <br>
                    <div id="post-gauge-roi-fields">
                    <b>GAUGES</b><br>
                    {% for postgaugeroi in postgaugerois %}
                        <div id="postgaugeroi_{{ loop.index }}">
                            <label for="postgaugeroi_{{ loop.index }}">GAUGE {{ loop.index }}:</label><br>
                            <input type="text" id="postgaugeroi_{{ loop.index }}_x" name="postgaugeroi_{{ loop.index }}_x" value="{{ postgaugeroi[0] }}" size="8" placeholder="X Position">
                            <input type="text" id="postgaugeroi_{{ loop.index }}_y" name="postgaugeroi_{{ loop.index }}_y" value="{{ postgaugeroi[1] }}" size="8" placeholder="Y Position">
                            <input type="text" id="postgaugeroi_{{ loop.index }}_w" name="postgaugeroi_{{ loop.index }}_w" value="{{ postgaugeroi[2] }}" size="8" placeholder="Width">
                            <input type="text" id="postgaugeroi_{{ loop.index }}_h" name="postgaugeroi_{{ loop.index }}_h" value="{{ postgaugeroi[3] }}" size="8" placeholder="Height"><br>
                        </div>
                    {% endfor %}
                    </div>
                <button type="button" id="add-post-gauge-roi">+</button>
                <button type="button" id="remove-post-gauge-roi">-</button><br>
                <h2>PiCamera Configuration</h2>
                <b>LED Enabled</b>
                <label for="picamera_led_enabled_true">Enabled</label>
                <input type="radio" id="picamera_led_enabled_true" name="picamera_led_enabled" value="True" {% if picamera_led_enabled %}checked{% endif %}>
                <label for="picamera_led_enabled_false">Disabled</label>
                <input type="radio" id="picamera_led_enabled_false" name="picamera_led_enabled" value="False" {% if not picamera_led_enabled %}checked{% endif %}>
                <br>
                <b>LED Brightness Configuration</b>
                <label for="picamera_led_brightness">Brightness:</label>
                <input type="range" id="picamera_led_brightness" name="picamera_led_brightness" min="0" max="100" value="{{ picamera_led_brightness }}">
                <br>
                <h2>Picture Configuration</h2>
                <b>Picture Brightness Configuration</b>
                <label for="picamera_image_brightness">Brightness:</label>
                <input type="range" id="picamera_image_brightness" name="picamera_image_brightness" min="0" max="100" value="{{ picamera_image_brightness }}">
                <br>
                <b>Picture Contrast Configuration</b>
                <label for="picamera_image_contrast">Brightness:</label>
                <input type="range" id="picamera_image_contrast" name="picamera_image_contrast" min="0" max="100" value="{{ picamera_image_contrast }}">
                <br>
                <input type="submit" value="UPDATE CONFIGS">
            </form>
        <form action="{{ url_for('read_image_route') }}" method="post">
            <button type="submit">READ DATA FROM AREAS</button><br>
        </form>
        <form action="{{ url_for('take_new_picture_route') }}" method="post">
            <button type="submit">TAKE NEW PICTURE</button><br>
        </form>
        <script>
            // PRE NUMBER ROI'S
            var preRoiCount = {{ prerois|length }};
            document.getElementById('add-pre-roi').addEventListener('click', function() {
                preRoiCount++;
                var preRoiField = document.createElement('div');
                preRoiField.innerHTML = `
                    <label for="preroi_${preRoiCount}">NUMBER ${preRoiCount}:</label><br>
                    <input type="text" id="preroi_${preRoiCount}_x" name="preroi_${preRoiCount}_x" size="8" placeholder="X Position">
                    <input type="text" id="preroi_${preRoiCount}_y" name="preroi_${preRoiCount}_y" size="8" placeholder="Y Position">
                    <input type="text" id="preroi_${preRoiCount}_w" name="preroi_${preRoiCount}_w" size="8" placeholder="Width">
                    <input type="text" id="preroi_${preRoiCount}_h" name="preroi_${preRoiCount}_h" size="8" placeholder="Height"><br>
                `;
                preRoiField.id = `preroi_${preRoiCount}`;
                document.getElementById('pre-roi-fields').appendChild(preRoiField);
            });

            document.getElementById('remove-pre-roi').addEventListener('click', function() {
                if (preRoiCount > 0) {
                    var preRoiField = document.getElementById(`preroi_${preRoiCount}`);
                    preRoiField.parentNode.removeChild(preRoiField);
                    preRoiCount--;
                }
            });
            // PRE GAUGE ROIS
            var preGaugeRoiCount = {{ pregaugerois|length }};
            document.getElementById('add-pre-gauge-roi').addEventListener('click', function() {
                preGaugeRoiCount++;
                var preGaugeRoiField = document.createElement('div');
                preGaugeRoiField.innerHTML = `
                    <label for="pregaugeroi_${preGaugeRoiCount}">GAUGE ${preGaugeRoiCount}:</label><br>
                    <input type="text" id="pregaugeroi_${preGaugeRoiCount}_x" name="pregaugeroi_${preGaugeRoiCount}_x" size="8" placeholder="X Position">
                    <input type="text" id="pregaugeroi_${preGaugeRoiCount}_y" name="pregaugeroi_${preGaugeRoiCount}_y" size="8" placeholder="Y Position">
                    <input type="text" id="pregaugeroi_${preGaugeRoiCount}_w" name="pregaugeroi_${preGaugeRoiCount}_w" size="8" placeholder="Width">
                    <input type="text" id="pregaugeroi_${preGaugeRoiCount}_h" name="pregaugeroi_${preGaugeRoiCount}_h" size="8" placeholder="Height"><br>
                `;
                preGaugeRoiField.id = `pregaugeroi_${preGaugeRoiCount}`;
                document.getElementById('pre-gauge-roi-fields').appendChild(preGaugeRoiField);
            });

            document.getElementById('remove-pre-gauge-roi').addEventListener('click', function() {
                if (preGaugeRoiCount > 0) {
                    var preGaugeRoiField = document.getElementById(`pregaugeroi_${preGaugeRoiCount}`);
                    preGaugeRoiField.parentNode.removeChild(preGaugeRoiField);
                    preGaugeRoiCount--;
                }
            });
             // POST NUMBER ROI'S
             var postRoiCount = {{ postrois|length }};
             document.getElementById('add-post-roi').addEventListener('click', function() {
                 postRoiCount++;
                 var postRoiField = document.createElement('div');
                 postRoiField.innerHTML = `
                     <label for="postroi_${postRoiCount}">AREA ${postRoiCount}:</label><br>
                     <input type="text" id="postroi_${postRoiCount}_x" name="postroi_${postRoiCount}_x" size="8" placeholder="X Position">
                     <input type="text" id="postroi_${postRoiCount}_y" name="postroi_${postRoiCount}_y" size="8" placeholder="Y Position">
                     <input type="text" id="postroi_${postRoiCount}_w" name="postroi_${postRoiCount}_w" size="8" placeholder="Width">
                     <input type="text" id="postroi_${postRoiCount}_h" name="postroi_${postRoiCount}_h" size="8" placeholder="Height"><br>
                 `;
                 postRoiField.id = `postroi_${postRoiCount}`;
                 document.getElementById('post-roi-fields').appendChild(postRoiField);
             });
 
             document.getElementById('remove-post-roi').addEventListener('click', function() {
                 if (postRoiCount > 0) {
                     var postRoiField = document.getElementById(`postroi_${postRoiCount}`);
                     postRoiField.parentNode.removeChild(postRoiField);
                     postRoiCount--;
                 }
             });
             // POST GAUGE ROIS
             var postGaugeRoiCount = {{ postgaugerois|length }};
             document.getElementById('add-post-gauge-roi').addEventListener('click', function() {
                 postGaugeRoiCount++;
                 var postGaugeRoiField = document.createElement('div');
                 postGaugeRoiField.innerHTML = `
                     <label for="postgaugeroi_${postGaugeRoiCount}">GAUGE ${postGaugeRoiCount}:</label><br>
                     <input type="text" id="postgaugeroi_${postGaugeRoiCount}_x" name="postgaugeroi_${postGaugeRoiCount}_x" size="8" placeholder="X Position">
                     <input type="text" id="postgaugeroi_${postGaugeRoiCount}_y" name="postgaugeroi_${postGaugeRoiCount}_y" size="8" placeholder="Y Position">
                     <input type="text" id="postgaugeroi_${postGaugeRoiCount}_w" name="postgaugeroi_${postGaugeRoiCount}_w" size="8" placeholder="Width">
                     <input type="text" id="postgaugeroi_${postGaugeRoiCount}_h" name="postgaugeroi_${postGaugeRoiCount}_h" size="8" placeholder="Height"><br>
                 `;
                 postGaugeRoiField.id = `postgaugeroi_${postGaugeRoiCount}`;
                 document.getElementById('post-gauge-roi-fields').appendChild(postGaugeRoiField);
             });
 
             document.getElementById('remove-post-gauge-roi').addEventListener('click', function() {
                 if (postGaugeRoiCount > 0) {
                     var postGaugeRoiField = document.getElementById(`postgaugeroi_${postGaugeRoiCount}`);
                     postGaugeRoiField.parentNode.removeChild(postGaugeRoiField);
                     postGaugeRoiCount--;
                 }
             });
        </script>
    </div>
    <div class="image">
        <img src="{{ url_for('preview_image') }}" alt="Preview image"><br>
        <b>Sensor data: {{ sensor_data }}</b><br>
        <b>Picture timestamp: {{ capture_timestamp }}</b><br>
    </div>
</div>
